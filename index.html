<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Franguinho Runner</title>
<style>
  body {
    margin: 0;
    background: #222;
    display: flex;
    flex-direction: column;
    align-items: center;
    font-family: Arial, sans-serif;
    color: white;
  }
  canvas {
    background: #333;
    display: block;
    margin-top: 20px;
    border: 2px solid #fff;
  }
  #score {
    margin-top: 10px;
    font-size: 20px;
  }
  .btn {
    margin: 5px;
    padding: 10px 20px;
    font-size: 16px;
    cursor: pointer;
    border: none;
    border-radius: 5px;
    background-color: #ff9900;
    color: #fff;
  }
  #startScreen {
    display: flex;
    flex-direction: column;
    align-items: center;
    margin-top: 50px;
  }
</style>
</head>
<body>

<div id="startScreen">
  <h1>Franguinho Runner</h1>
  <button class="btn" id="startBtn">Iniciar Jogo</button>
</div>

<canvas id="game" width="600" height="400" style="display:none;"></canvas>
<div id="score" style="display:none;">Pontuação: 0 | Desconto: R$0.00</div>

<div id="controls" style="display:none;">
  <button class="btn" id="jumpBtn">Pular</button>
  <button class="btn" id="restartBtn">Reiniciar</button>
</div>

<script>
const canvas = document.getElementById('game');
const ctx = canvas.getContext('2d');

let frango = { x: 50, y: 300, width: 50, height: 50, dy: 0 };
let gravidade = 0.8;
let pulo = -12;

let moedas = [];
let obstaculos = [];
let score = 0;
let gameOver = false;
let jogoIniciado = false;

// --- CONTROLES ---
document.getElementById('jumpBtn').addEventListener('click', () => {
    if(!gameOver) frango.dy = pulo;
});
document.getElementById('restartBtn').addEventListener('click', () => {
    restartGame();
});

// --- BOTÃO INICIAR ---
document.getElementById('startBtn').addEventListener('click', () => {
    document.getElementById('startScreen').style.display = 'none';
    canvas.style.display = 'block';
    document.getElementById('score').style.display = 'block';
    document.getElementById('controls').style.display = 'block';
    jogoIniciado = true;
    update();
});

// Teclas também funcionam
document.addEventListener('keydown', e => {
    if(e.code === 'Space' && !gameOver && jogoIniciado){
        frango.dy = pulo;
    } else if(e.code === 'Space' && gameOver){
        restartGame();
    }
});

// --- FUNÇÕES ---
function spawnMoeda() {
    moedas.push({
        x: canvas.width,
        y: Math.random() * (canvas.height - 30),
        width: 30,
        height: 30
    });
}

function spawnObstaculo() {
    obstaculos.push({
        x: canvas.width,
        y: canvas.height - 50,
        width: 50,
        height: 50
    });
}

function restartGame() {
    moedas = [];
    obstaculos = [];
    score = 0;
    frango.y = 300;
    frango.dy = 0;
    gameOver = false;
    updateScore();
    if(!jogoIniciado) return;
    update();
}

function updateScore() {
    let desconto = (score * 0.10).toFixed(2);
    document.getElementById('score').innerText = "Pontuação: " + score + " | Desconto: R$" + desconto;
}

function update() {
    if(gameOver) return;

    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // Frango (retângulo amarelo)
    frango.dy += gravidade;
    frango.y += frango.dy;
    if(frango.y + frango.height > canvas.height) {
        frango.y = canvas.height - frango.height;
        frango.dy = 0;
    }
    ctx.fillStyle = "yellow";
    ctx.fillRect(frango.x, frango.y, frango.width, frango.height);

    // Moedas
    moedas.forEach((m, i) => {
        m.x -= 4;
        ctx.fillStyle = "gold";
        ctx.beginPath();
        ctx.arc(m.x + m.width/2, m.y + m.height/2, m.width/2, 0, Math.PI*2);
        ctx.fill();
        if(frango.x < m.x + m.width && frango.x + frango.width > m.x &&
           frango.y < m.y + m.height && frango.y + frango.height > m.y) {
            moedas.splice(i, 1);
            score += 1;
            updateScore();
        }
        if(m.x + m.width < 0) moedas.splice(i,1);
    });

    // Obstáculos
    obstaculos.forEach((o, i) => {
        o.x -= 6;
        ctx.fillStyle = "red";
        ctx.fillRect(o.x, o.y, o.width, o.height);
        if(frango.x < o.x + o.width && frango.x + frango.width > o.x &&
           frango.y < o.y + o.height && frango.y + frango.height > o.y) {
            gameOver = true;
            alert("Game Over! Pontuação: " + score + " | Desconto: R$" + (score*0.10).toFixed(2));
        }
        if(o.x + o.width < 0) obstaculos.splice(i,1);
    });

    requestAnimationFrame(update);
}

// Spawn aleatório
setInterval(() => { if(!gameOver && jogoIniciado) spawnMoeda(); }, 2000);
setInterval(() => { if(!gameOver && jogoIniciado) spawnObstaculo(); }, 3000);
</script>
</body>
</html>
